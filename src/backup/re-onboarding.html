<section class="ad-bg-white ad-border-b-1 ad-border-gray-shadeOne">
    <section class="ad-container ad-py-24 ad-flex ad-justify-between">
        <h3 class="ad-text-22 ad-text-blue-header">Register Reporting Entity</h3>
    </section>
</section>

<section>
    <section style="width: 647px; margin: 0 auto;">
        <section class="ad-pt-32 ad-mb-24">
            <h3 data-handler="re-child-slide-up"
                class="slider-activator-custom ad-flex ad-justify-between ad-text-blue-header ad-text-18 ad-font-bold ad-border-b-1 ad-border-gray-shadeOne ad-py-8 ad-leading-20">
                <label>Reporting entity information</label>
                <span class="">
                    <svg class="ad-inline" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M12 7.5L19.5 15L18.45 16.05L12 9.6L5.55 16.05L4.5 15L12 7.5Z" fill="black" />
                    </svg>

                </span>
            </h3>
        </section>
        <section class="ad-pb-16">
            <h3 
            class="ad-flex ad-justify-between ad-text-blue-header ad-text-16 ad-font-bold ad-py-8 ad-leading-20">
            <label>Reporting Entity Status</label>
        </h3>
            <div class="ad-text-blue-header ad-flex">
                <div class="radio">
                    <input id="activeEntity" name="radio" type="radio" checked="">
                    <label for="activeEntity" class="radio-label">Active</label>
                </div>
    
                <div class="radio">
                    <input id="disableEntity" name="radio" type="radio">
                    <label for="disableEntity" class="radio-label">Deactive</label>
                </div>
            </div>
        </section>
        <form id="entity-onboarding" method="POST" action="/companyonboarding">
            <div class="re-child-slide-up">
                <p class="ad-mb-32">
                    <label class="ad-text-blue-header ad-mb-4 ad-leading-20 ad-block ad-font-bold">Reporting Entity
                        Name</label>
                    <input id="unique-entity-name" name="entity-name"
                        class="ad-block ad-border-solid ad-border-1 ad-border-gray-shadeOne ad-rounded-2 ad-w-full ad-p-12 ad-text-blue-header ad-mb-8"
                        type="text" data-error-default="entity name" placeholder="Entity Name" data-validation-type="allowspaces">
                </p>
                <section id="securityContainer">
                </section>
                <label id="add-anotherSecurity" class="ad-text-blue-shadeFour ad-cursor-pointer ad-text-12 ad-flex ad-items-center">
                    <svg class="ad-inline ad-mr-8" width="16" height="16" viewBox="0 0 16 16" fill="none"
                        xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M8 1C4.2 1 1 4.2 1 8C1 11.8 4.2 15 8 15C11.8 15 15 11.8 15 8C15 4.2 11.8 1 8 1ZM12 9H9V12H7V9H4V7H7V4H9V7H12V9Z"
                            fill="#0051A2" />
                    </svg>Add another security</label>
            </div>
            <section class="ad-pt-40 ad-mb-16">
                <h3
                    class="ad-text-blue-header ad-text-18 ad-font-bold ad-border-b-1 ad-border-gray-shadeOne ad-py-8 ad-leading-20">
                    Primary user information
                </h3>
            </section>
            <p class="ad-text-blue-shadeFive">There can be a maximum of 2 primary users for a registered reporting
                entity.</p>
            <section id="primaryUser">

            </section>
            <label id="add-PrimaryUser" class="ad-text-blue-shadeFour ad-cursor-pointer ad-text-12 ad-flex ad-items-center">
                <svg class="ad-inline ad-mr-8" width="16" height="16" viewBox="0 0 16 16" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M8 1C4.2 1 1 4.2 1 8C1 11.8 4.2 15 8 15C11.8 15 15 11.8 15 8C15 4.2 11.8 1 8 1ZM12 9H9V12H7V9H4V7H7V4H9V7H12V9Z"
                        fill="#0051A2" />
                </svg>
                Add another primary user</label>
            <p class="ad-text-blue-shadeTwo ad-flex ad-items-center ad-pt-40 ad-mt-16">
                <input data-field="required" type="checkbox" class="ad-mr-8 ad-inline-block"> I confirm I want to
                register this entity and add a primary user as
                well</p>
            <p class="ad-flex ad-justify-end ad-py-32">
                <button
                    class="ad-text-blue-shadeFour ad-font-semibold ad-text-12 ad-border-solid ad-border-1 ad-border-blue-shadeFour ad-rounded-2 ad-py-8 ad-px-12 ad-mr-16">Cancel</button>
                <button type="submit"
                    class="ad-bg-blue-shadeFour ad-text-white ad-text-12 ad-py-8 ad-px-12 ad-rounded-2">Submit</button>
            </p>
        </form>
    </section>
</section>
<section id="succes-message-report" class="ad-hidden">
    <section class="ad-py-40 ad-px-24 ad-bg-white ad-mb-16 ad-text-center">
        <h4 class="ad-text-18 ad-font-semibold ad-mb-8 ad-text-blue-header">Reporting Entity Registered</h4>
        <p class="ad-text-blue-shadeFive ad-mb-20"><label id="success-message-onboarding"></label> has been registered successfully. A login link has been shared with the registered emal ID of the primary user(s).</p>
        <a href="/" class="ad-text-blue-shadeFour ad-font-semibold ad-text-12 ad-border-solid ad-border-1 ad-border-blue-shadeFour ad-rounded-2 ad-py-8 ad-px-12">Close</a>
    </section>
</section>

<section id="disclosureType" class="ad-hidden">
    <ul>
        <li><a data-value="1" href="">Option</a></li>
        <li><a data-value="2" href="">Option</a></li>
        <li><a data-value="3" href="">Option</a></li>
        <li><a data-value="4" href="">Option</a></li>
        <li><a data-value="5" href="">Option</a></li>
        <li><a data-value="6" href="">Option</a></li>
        <li><a data-value="7" href="">Option</a></li>
    </ul>
</section>

<script>
    var payload = {
        "reportingEntity": {
            "Title": "Test Reporting Entity",
            "userRegisterInformation": [
                {
                    "FirstName": "Samir",
                    "LastName": "Parmar",
                    "Email": "Samir.Parmar@test.com",
                    "PhoneNumber": "9428261900",
                    "JobTitle": "Test"
                }
            ],
            "securityDetails": [
                {
                    "SecurityName": "TRESN2",
                    "SecurityCode": "TRESC2",
                    "SecurityTypeID": "{99DD2F97-7CDE-4BA4-8D4A-481AC02A4A59}",
                    "MICCode": "MICCodeTRE2",
                    "Ticker": "TRE2Ticker"
                }
            ]
        }
    };
    function validateOnboardingForm(event) {alert(1)
        let secutiryDetails = event.target.querySelectorAll('#securityContainer > section');
        let securityDetail = [];
        secutiryDetails.forEach((element, index) => {
            let inputs = element.querySelectorAll("input");
            let select = element.querySelectorAll(".dropDownControl.onboarding");
            let selectValue=$(select).data('value');
            let details = {
                SecurityTypeID: selectValue
            }
            inputs.forEach((elem) => {
                if (elem.name == "security-name") {
                    details.SecurityName = elem.value
                }
                else if (elem.name == "security-code") {
                    details.SecurityCode = elem.value;
                }
                else if (elem.name == "mic-code") {
                    details.MICCode = elem.value
                } else if (elem.name == "ticker") {
                    details.Ticker = elem.value
                }
            })

            securityDetail[index] = details;
        });

        let userDetails = event.target.querySelectorAll('#primaryUser > section');
        let userList = [];
        userDetails.forEach((element, index) => {
            let inputs = element.querySelectorAll("input");
            let details = {}
            inputs.forEach((elem) => {
                if (elem.name == "first-name") {
                    details.FirstName = elem.value
                }
                else if (elem.name == "last-name") {
                    details.LastName = elem.value;
                }
                else if (elem.name == "email-address") {
                    details.Email = elem.value
                } else if (elem.name == "phone") {
                    details.PhoneNumber = elem.value
                }
                else if (elem.name == "designation") {
                    details.JobTitle = elem.value
                }
            })
            userList[index] = details;
        });

        payload.reportingEntity.securityDetails=securityDetail;
        payload.reportingEntity.userRegisterInformation=userList;
        let entityName=document.getElementById("unique-entity-name").value
        payload.reportingEntity.Title=entityName;

        console.log(payload.reportingEntity)
        
        // if api success
        $("#succes-message-report").removeClass('ad-hidden').addClass('ad-flex')
        $("#success-message-onboarding").text(entityName)
        event.preventDefault()
    }

    function validateEntityEditingForm(event){
        let secutiryDetails = event.target.querySelectorAll('#securityContainerEdit > section');
        let securityDetail = [];
        event.preventDefault()
        secutiryDetails.forEach((element, index) => {
            let inputs = element.querySelectorAll("input");
            let select = element.querySelectorAll(".dropDownControl.default");
            let selectValue=$(select).data('value');
            let details = {
                SecurityTypeID: selectValue
            }
            inputs.forEach((elem) => {
                if (elem.name == "security-name") {
                    details.SecurityName = elem.value
                }
                else if (elem.name == "security-code") {
                    details.SecurityCode = elem.value;
                }else if(elem.name==security-id){
                    details.SecurityId=elem.value
                }
                else if (elem.name == "mic-code") {
                    details.MICCode = elem.value
                } else if (elem.name == "ticker") {
                    details.Ticker = elem.value
                }
            })

            securityDetail[index] = details;
        });

        let entityName=document.getElementById("unique-entity-name").value
        payload.reportingEntity.Title=entityName;

        console.log(payload.reportingEntity)
        
        // if api success
        $("#succes-message-report").removeClass('ad-hidden').addClass('ad-flex')
        $("#success-message-onboarding").text(entityName)
        event.preventDefault()
    }

</script>